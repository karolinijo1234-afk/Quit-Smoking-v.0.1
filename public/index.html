<script>
    const recordBtn = document.getElementById('recordBtn');
    const recordsList = document.getElementById('records');
    const totalTodayEl = document.getElementById('totalToday');
    const avgTimeEl = document.getElementById('avgTime');
    const lastTimeEl = document.getElementById('lastTime');

    // Lithuanian time zone
    const LT_TIMEZONE = 'Europe/Vilnius';

    async function loadRecords() {
        const res = await fetch('/records');
        const data = await res.json();

        // Show all records
        recordsList.innerHTML = data.map(r => {
            const localTime = new Date(r.timestamp).toLocaleString('lt-LT', { timeZone: LT_TIMEZONE });
            return `<li>${localTime}</li>`;
        }).join('');

        // Filter today's records (Lithuanian date)
        const today = new Date().toLocaleDateString('lt-LT', { timeZone: LT_TIMEZONE });
        const todayRecords = data.filter(r => {
            const recDate = new Date(r.timestamp).toLocaleDateString('lt-LT', { timeZone: LT_TIMEZONE });
            return recDate === today;
        });

        // Total today
        totalTodayEl.textContent = todayRecords.length;

        // Last press time
        if (todayRecords.length > 0) {
            const last = new Date(todayRecords[0].timestamp); // first in list is latest
            lastTimeEl.textContent = last.toLocaleString('lt-LT', { timeZone: LT_TIMEZONE });
        } else {
            lastTimeEl.textContent